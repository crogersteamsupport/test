<!DOCTYPE html>
<html lang="en">
<head>
  <title></title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="../Css/bootstrap3.css" rel="stylesheet" type="text/css" />
  <link href="../Css/font-awesome.min.css" rel="stylesheet" type="text/css" />
  <link href="../Css/tsbs.css" rel="stylesheet" type="text/css" />
  <!--[if IE]><link href="../Css/tsbs-ie.css" rel="stylesheet" type="text/css" /><![endif]-->
  <link href="AgentCustomerChat.css" rel="stylesheet" type="text/css" />

  <script src="../Js/Ts/ts.pendo.js" type="text/javascript"></script>
    <script src="/frontend/library/jquery-1.11.0.min.js" type="text/javascript"></script>
  <script src="/frontend/library/bootstrap3.min.js" type="text/javascript"></script>
  <script src="/frontend/library/moment.min.js" type="text/javascript"></script>
    <script src="/frontend/library/browser.js" type="text/javascript"></script>
  <script src="https://js.pusher.com/3.1/pusher.min.js"></script>
  <script src="AgentCustomerChatPusher.js" type="text/javascript"></script>
  <script src="AgentCustomerChatTOK.js" type="text/javascript"></script>
  <script src="AgentCustomerChat.js" type="text/javascript"></script>
  <script src="//static.opentok.com/v2/js/opentok.min.js"></script>
  <script src="/frontend/library/moment.min.js" type="text/javascript"></script>
  <script src="/frontend/library/jquery-ui-latest.custom.min.js" type="text/javascript"></script>
    <script src="/frontend/library/jquery.fileupload.js" type="text/javascript"></script>

    <script src="/frontend/javascript/vendors/growthscore.js?1515087127" type="text/javascript"></script>
</head>
<body>
    <input id="hiddenAttachmentInput" type="file" name="somename" size="chars" style="display:none;">
    <div class="ts-loading page-loading"></div>
    <div class="frame-container" style="display:none;">
        <div class="container-fluid">
            <div class="row">
                <div class="col-sm-4 col-md-3 col-lg-3">
                    <div class="row chats-row">
                        <div id="chats-requests" class="col-md-12"></div>
                        <div id="chats-accepted" class="col-md-12"></div>
                    </div>
                </div>
                <div class="col-sm-8 col-md-9 col-lg-9 current-chat ">
                    <div class="row chat-toolbar-row">
                        <div class="col-sm-12">
                            <div class="btn-group chat-toolbar" role="group" aria-label="...">
                                <button id="chat-leave" class="btn btn-default disabled" type="button">
                                    <i class="fa fa-remove-sign"></i> Leave Chat
                                </button>
                                <button id="chat-invite" class="btn btn-default disabled" type="button">
                                    <i class="fa fa-plus"></i> Invite Agent
                                </button>
                                <button id="chat-customer" class="btn btn-default disabled" type="button">
                                    <i class="fa fa-user"></i> Customer
                                </button>
                            </div>
                            <div class="btn-group chat-toolbar" role="group" aria-label="...">
                                <button id="chat-suggestions" class="btn btn-default" type="button" title="Knowlege Base">
                                    <i class="fa fa-book"></i>
                                </button>
                                <button id="chat-attachment" class="btn btn-default" type="button" title="Attachment">
                                    <i class="fa fa-paperclip"></i>
                                </button>
                            </div>
                            <div class="btn-group ticket-toolbar" role="group" aria-label="...">
                                <button type="button" class="btn btn-default ticket-option dropdown-toggle" data-toggle="dropdown">Ticket&nbsp;<span class="caret"></span></button>
                                <ul class="dropdown-menu ticket-menu-actions" role="menu">
                                    <li><a id="Ticket-Create">Create Ticket</a></li>
                                    <li><a id="Ticket-Open">Open Ticket</a></li>
                                    <li><a id="Ticket-Add">Add to Ticket</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="row current-chat-area">
                        <div class="col-md-12">
                            <div class="chat-intro"></div>
                            <ul class="media-list"></ul>
                            <p id="typing" style="display:none; position:fixed; bottom: 50px;">user is typing...</p>
                        </div>
                    </div>
                    <div class="row current-chat-footer">
                        <div class="panel-footer">
                            <div style="display: none;" id="tokStreamControls">
                                <div id="tokStatusText"></div>
                                <button type="button" id="muteStream" class="btn btn-primary" title="Mute Audio" onClick="muteTOKStream()"><i class="fa fa-microphone"></i></button>
                                <button type="button" id="unmuteStream" class="btn btn-danger" title="UnMute Audio" style="display:none;" onClick="unmuteTOKStream()"><i class="fa fa-microphone-slash"></i></button>
                                <button type="button" id="stopStream" class="btn btn-danger" title="Stop Streaming" onClick="stopTOKStream()"><i class="fa fa-stop"></i></button>
                                <meter id="subscriberMeter" value="0"></meter>
                            </div>
                            <div id="audioTOKContainer"></div>
                            <div class="btn-group btn-group-justified tok-controls" role="group" aria-label="...">
                                <div id="chat-tok-audio" class="btn-group" role="group">
                                    <button type="button" class="btn btn-primary">
                                        <span class="fa fa-phone"></span>
                                        <span>Go to Audio</span>
                                    </button>
                                </div>
                                <div id="chat-tok-video" class="btn-group" role="group" title="">
                                    <button type="button" class="btn btn-primary">
                                        <span class="fa fa-video-camera"></span>
                                        <span>Go to Video</span>
                                    </button>
                                </div>
                                <div id="chat-tok-screen" class="btn-group" role="group">
                                    <button type="button" class="btn btn-primary">
                                        <span class="fa fa-desktop"></span>
                                        <span>Share Screen</span>
                                    </button>
                                </div>
                            </div>
                            <form id="message-form" action="">
                                <div class="input-group">
                                    <textarea id="message" rows="3" class="form-control" autocomplete="off"></textarea>
                                    <span class="input-group-btn">
                                        <button id="new-message" class="btn btn-default" type="submit">Send</button>
                                    </span>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="x" style="font-size: 0;"></div>
        <div id="jquery_jplayer_1" class="jp-jplayer"></div>
    </div>
    <div id="chat-add-user-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="userModalTitle" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="userModalTitle">Invite User</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="chat-invite-user">Who do you want to invite?</label>
                        <input class="col-md-10 form-control chat-user-list" id="chat-invite-user" placeholder="Enter partial name then select name from list">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button id="add-user-save" type="button" class="btn btn-primary">Start</button>
                </div>
            </div>
        </div>
    </div>
    <div id="chat-transfer-user-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="userModalTitle" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="userModalTitle">Transfer User</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="chat-transfer-user">Who do you want to invite?</label>
                        <input class="col-md-10 form-control chat-user-list" id="chat-transfer-user" placeholder="Enter partial name then select name from list">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button id="add-user-save" type="button" class="btn btn-primary">Save</button>
                </div>
            </div>
        </div>
    </div>
    <div id="chat-add-ticket-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="userModalTitle" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="userModalTitle">Add to Ticket</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="chat-add-ticket">What ticket do you want to add this chat to?</label>
                        <input class="col-md-10 form-control chat-tickets-list" id="chat-add-ticket" placeholder="Enter ticket number">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button id="ticket-add-save" type="button" class="btn btn-primary">Save</button>
                </div>
            </div>
        </div>
    </div>
    <div id="SuggestedSolutionsModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="SuggestedSolutionModalTitle" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="SuggestedSolutionsModalTitle">Insert Knowledgebase</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <div class="dialog-select-ticket2" title="Select a Ticket">
                            <p>Search a ticket number or description:</p>
                            <input type="text" class="text ui-corner-all ui-widget-content" style="width:50%;" id="dialog-select-ticket2-input" />
                        </div>
                    </div>
                    <p>Or select a suggested solution:</p>
                    <iframe id="SuggestedSolutionsIFrame" class="afterSearch" src="" style="width:100%; height:350px;"></iframe>
                </div>
                <div class="modal-footer" style="margin-top: -16px">
                    <button id="InsertSuggestedSolutionsLink" type="button" class="btn btn-primary afterSearch">Insert Link</button>
                    <button id="InsertSuggestedSolutions" type="button" class="btn btn-primary afterSearch">Insert Article</button>
                    <button type="button" class="btn btn-default afterSearch" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div id="ChromeInstallModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Extension Required</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <p>An Extension is required in order for Screen Sharing to function properly. Please select your browswer and install the extension. Once the installation is complete close this dialog and click the Record Screen button again.</p>
                        <p id="chromemodalbutton"><a href="https://chrome.google.com/webstore/detail/teamsupport-screen-sharin/dlbbnbankbgdoidhinoomgojjbdamofh?hl=en-US" target="_blank" class="btn btn-primary" role="button">Install Extension</a></p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div id="FireFoxInstallModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Extension Required</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <p>An Extension is required in order for Screen Sharing to function properly. Please install the browser extension. Once the installation is complete you will need to refresh your browser for the installation to complete. Please save your ticket action text if any before proceeding.</p>
                        <p id="firefoxmodalbutton"><a href="../../../ScreenShare/ScreenSharing.xpi" class="btn btn-info" role="button">Add to Firefox</a></p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div id="screenStreamModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">
                    <div style="text-align: center; display: none;" id="screenStreamingContrainer">
                        <div id="screenStream" style="margin:auto; margin-bottom:6px; display:block; height:450px; width:450px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Templates -->
    <script id="message-template" type="text/x-custom-template">
        <li class="media" {{HasLeftChat}}>
            <div class="media-body">
                <div class="media">
                    <img class="pull-{{MessageDirection}} media-object img-circle user-avatar" src="{{Avatar}}">
                    <div class="media-body">
                        {{Message}}
                        <br>
                        <small class="text-muted">{{UserName}} | {{Date}}</small>
                        <hr>
                    </div>
                </div>
            </div>
        </li>
    </script>
    <script id="tok-video-template" type="text/x-custom-template">
        <li id="videoRequest" class="media">
            <div class="media-body">
                <div class="media">
                    <img class="pull-left media-object img-circle user-avatar" src="../images/blank_avatar.png">
                    <div class="media-body">
                        {{message}} <a onClick="subscribeToVideoStream()">Do you Accept?</a>
                        <br>
                        <label class="tokWarning">(If you accept the customer will see you via your camera)</label>
                        <br>
                        <small class="text-muted">{{UserName}} | {{Date}}</small>
                        <hr>
                    </div>
                </div>
            </div>
        </li>
    </script>
    <script id="tok-audio-template" type="text/x-custom-template">
        <li id="audioRequest" class="media">
            <div class="media-body">
                <div class="media">
                    <img class="pull-left media-object img-circle user-avatar" src="../images/blank_avatar.png">
                    <div class="media-body">
                        {{message}} <a onClick="subscribeToAudioStream()">Do you Accept?</a>
                        <br>
                        <label class="tokWarning">(If you accept the customer will hear what you say in your microphone)</label>
                        <br>
                        <small class="text-muted">{{UserName}} | {{Date}}</small>
                        <hr>
                    </div>
                </div>
            </div>
        </li>
    </script>
    <script id="tok-screen-template" type="text/x-custom-template">
        <li id="screenRequest" class="media">
            <div class="media-body">
                <div class="media">
                    <img class="pull-left media-object img-circle user-avatar" src="../images/blank_avatar.png">
                    <div class="media-body">
                        {{message}} <a onClick="subscribeToScreenStream()">Do you Accept?</a>
                        <br>
                        <label class="tokWarning">(If you accept you will be seeing the customer's screen)</label>
                        <br>
                        <small class="text-muted">{{UserName}} | {{Date}}</small>
                        <hr>
                    </div>
                </div>
            </div>
        </li>
    </script>

    <script id="typing-template" type="text/x-custom-template">
        <li id="typing" class="media">
            <div class="media-body">
                <div class="media">
                    <img class="pull-left media-object img-circle user-avatar" src="../images/blank_avatar.png">
                    <div class="media-body">
                        {{message}}
                        <br>
                        <small class="text-muted">{{UserName}} | {{Date}}</small>
                        <hr>
                    </div>
                </div>
            </div>
        </li>
    </script>

    <script src="/frontend/library/jquery.jplayer.min.js" type="text/javascript"></script>
</body>
</html>
